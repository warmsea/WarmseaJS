/*!
 * warmsea JavaScript Library v0.3.0
 *
 * Copyright 2009, 2014 Su Su
 * Released under the MIT license
 *
 * Date: 2014-04-01
 */
!function(a){"use strict";var b={};b.noop=function(){},b.identity=function(a){return a},b.unimplemented=function(){var a="Unimplemented function.";if(!b.isFunction(b.error))throw new Error(a);b.error(a)},b.error=function(a){throw new Error(a)},b.cmp=function(a,b){return a>b?1:b>a?-1:0},b.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},b.values=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},b.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=0,e=Math.max(Math.ceil((b-a)/c),0),f=new Array(e);e>d;)f[d++]=a,a+=c;return f},b.sort=function(a,c){c=c||b.cmp;var d,e=a.length;for(d=0;e>d;++d)a[d]._wssi=d;for(a.sort(function(a,b){return c(a,b)||a._wssi-b._wssi}),d=0;e>d;++d)delete a[d]._wssi;return a},b.min=function(){if(!arguments.length)return void 0;var a,c;if(b.isFunction(arguments[0])?(a=arguments[0],c=Array.prototype.slice.call(arguments,1)):(a=b.cmp,c=Array.prototype.slice.call(arguments,0)),!c.length)return void 0;for(var d=b.isArray(c[0])?c[0]:c,e=d[0],f=1,g=d.length;g>f;++f)a(e,d[f])>0&&(e=d[f]);return e},b.max=function(){if(!arguments.length)return void 0;var a,c;if(b.isFunction(arguments[0])?(a=arguments[0],c=Array.prototype.slice.call(arguments,1)):(a=b.cmp,c=Array.prototype.slice.call(arguments,0)),!c.length)return void 0;for(var d=b.isArray(c[0])?c[0]:c,e=d[0],f=1,g=d.length;g>f;++f)a(e,d[f])<0&&(e=d[f]);return e},b.bool=function(a){var c=a;return b.isObject(c)&&"__bool__"in c?b.bool(b.isFunction(c.__bool__)?c.__bool__():c.__bool__):!!a},b.i=function(a,c){var d=a;return d===!0?1:b.isObject(d)&&"__int__"in d?b.i(b.isFunction(d.__int__)?d.__int__():d.__int__,c):c||!b.isString(d)||0!==d.indexOf("0x")&&0!==d.indexOf("0X")?c&&10!==c?parseInt(d,c):Math.round(parseFloat(d)):parseInt(d,16)},b.f=function(a){var c=a;return c===!0?1:b.isObject(c)&&"__float__"in c?b.f(b.isFunction(c.__float__)?c.__float__():c.__float__):parseFloat(c)},b.str=function(a){var c=a;return b.isObject(c)&&"__str__"in c?b.str(b.isFunction(c.__str__)?c.__str__():c.__str__):String(a)},b.array=function(a){return b.isArray(a)?a:void 0===a||null===a?[]:[a]},b.isNumber=function(a){return"number"==typeof a},b.isString=function(a){return"string"==typeof a},b.isArray=function(a){return a instanceof Array},b.isFunction=function(a){return"function"==typeof a},b.isPlainObject=function(a){if("[object Object]"!==String(a))return!1;try{if(!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1}catch(b){return!1}return!0},b.isObject=function(a){return null!==a&&"object"==typeof a},b.pad=function(a,c,d){a=b.str(a),c=b.max(0,void 0===c?2:c,a.length),d=b.str(d||"0");var e=new Array(Math.ceil((c-a.length)/d.length)+1);return e.join(d).substring(0,c-a.length)+a},b.format=function(a){if(!arguments.length)return"";a=c(arguments[0]);var e;e=b.isArray(arguments[1])?arguments[1]:b.isPlainObject(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1);var f=new d(e),g=/%(?:\((.*?)\))?([#|0|\-| |\+]+)?(\d+|\*)?(?:.(\d+|\*))?(?:[h|l|L])?(.)?/g;return a=a.replace(g,function(){return d.prototype.convert.apply(f,arguments)})};var c=function(a){if(b.isString(a))return a;if(!b.isFunction(a))return b.str(a);for(var c,d,e,f=b.str(a).split(/\r?\n/),g=0,h=0,i=f.length,j={},k=null;i>g;){var l=f[g++].match(/^[ \t]*\/\*!?<<<(\w+)(?:;(.+)?)?$/);if(l){c=g,e=l[1];var m=(l[2]||"").split(/[ \t]*,[ \t]*/);for(h=0;h<m.length;++h){var n=m[h].toLowerCase().split(/-(.*)/);n[0]&&(j[n[0]]=n[1]||!0)}break}}c||b.error("Format failed: start line missing"),j.ws=j.ws||"outdent";for(var o=[];i>g;){var p=f[g];if(p.match(new RegExp("^[ \\t]*"+e+"\\*\\/"))){d=g;break}if(g++,"outdent"===j.ws){var q=p.match(/^([ \t]*).*$/),r=q[1];if(null===k)k=r;else{for(h=0;h<k.length&&h<r.length&&k[h]===r[h];)h++;k.length>h&&(k=k.substring(0,h))}}o.push(p)}d||b.error("Format failed: end line missing");var s;switch(j.ws){case"outdent":s=function(a){return a.substring(k.length)};break;case"keep":s=b.identity;break;case"trim":s=function(a){return a.trim()};break;default:b.error("Format failed: Unsupported WS option")}for(g=0,i=o.length;i>g;++g)o[g]=s(o[g]);return o.join("\n")},d=function(a){this.params=a||[],this.index=0};d.prototype.convert=function(a,c,d,e,f,g,h){void 0===g&&b.error('format incomplete specifier "%s" in position (%d).',a,h),this.convertors.hasOwnProperty(g)||b.error('format unsupported type "%s" in position (%d)',g,h);var i;if("*"===e&&(i=this.index++,this.params.hasOwnProperty(i)||b.error('format key error "%s" in position (%d).',c,h),e=this.params[i]),e=e||0,"*"===f&&(i=this.index++,this.params.hasOwnProperty(i)||b.error('format key error "%s" in position (%d).',c,h),f=this.params[i]),void 0===f&&(f=6),"%"===g||"/"===g)return g;c=void 0===c?this.index++:c,this.params.hasOwnProperty(c)||b.error('format key error "%s" in position (%d).',c,h);var j=this.params[c];return d=d||"",d={"#":d.indexOf("#")>=0,0:d.indexOf("0")>=0&&d.indexOf("-")<0,"-":d.indexOf("-")>=0," ":d.indexOf(" ")>=0&&d.indexOf("+")<0,"+":d.indexOf("+")>=0},this.convertors[g](j,d,e,f)},d.prototype.convertors={d:function(a,b,c){return d.prototype.convertors.ic("d",a,b,c)},o:function(a,b,c){return d.prototype.convertors.ic("o",a,b,c)},x:function(a,b,c){return d.prototype.convertors.ic("x",a,b,c)},X:function(a,b,c){return d.prototype.convertors.ic("X",a,b,c)},f:function(a,c,d,e){a=b.f(a);var f=0>a?"-":c["+"]?"+":c[" "]?" ":"";a=Math.abs(a).toFixed(e),c["#"]&&0===e&&(a+=".");var g=b.max(0,d-a.length-f.length);return c["-"]?f+a+b.pad("",g," "):c[0]?f+b.pad("",g,"0")+a:b.pad("",g," ")+f+a},s:function(a,c,d){a=b.str(a);var e=b.max(0,d-a.length);return c["-"]?a+b.pad("",e," "):b.pad("",e," ")+a},"%":function(){return this.index--,"%"},"/":function(){return this.index--,"/"},ic:function(a,c,d,e){c=b.i(c);var f=0>c?"-":d["+"]?"+":d[" "]?" ":"",g=d["#"]?{d:"",o:"0",x:"0x",X:"0X"}[a]:"";c=Math.abs(c).toString({d:10,o:8,x:16,X:16}[a]);var h=b.max(0,e-g.length-c.length-f.length),i="";return i=d["-"]?f+g+c+b.pad("",h," "):d[0]?f+g+b.pad("",h,"0")+c:b.pad("",h," ")+f+g+c,"X"===a&&(i=i.toUpperCase()),i}},"function"==typeof define&&define.amd?define(function(){return b}):a.warmsea=b}(this);